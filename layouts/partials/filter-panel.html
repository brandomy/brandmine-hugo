{{ $dimensions := .Site.Data.dimensions.dimensions }}

<div id="filter-panel" class="filter-panel">
  <div class="filter-header">
    <h3>{{ i18n "filter_brands" | default "Filter Brands" }}</h3>
    <button class="filter-clear" data-clear-filters>
      {{ i18n "clear_all" | default "Clear all" }}
      <span class="filter-count" data-filter-count hidden>0</span>
    </button>
  </div>

  <!-- Markets Filter -->
  {{ with $dimensions.markets }}
    <div class="filter-group">
      <h4 class="filter-group-title" style="color: {{ .colorHex }}">
        <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
          <path d="M8 0a5 5 0 0 0-5 5c0 2.5 5 11 5 11s5-8.5 5-11a5 5 0 0 0-5-5zm0 7a2 2 0 1 1 0-4 2 2 0 0 1 0 4z"/>
        </svg>
        {{ .title }}
      </h4>
      <div class="filter-options">
        {{ $taxonomy := $.Site.Taxonomies.markets }}
        {{ range $taxonomy.Alphabetical }}
          <label class="filter-option">
            <input type="checkbox" data-taxonomy="markets" value="{{ .Page.Title }}">
            <span>{{ .Page.Title | humanize }} <small>({{ .Count }})</small></span>
          </label>
        {{ end }}
      </div>
    </div>
  {{ end }}

  <!-- Sectors Filter -->
  {{ with $dimensions.sectors }}
    <div class="filter-group">
      <h4 class="filter-group-title" style="color: {{ .colorHex }}">
        <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
          <path d="M2 2a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H2zm0 1h12a1 1 0 0 1 1 1v1H1V4a1 1 0 0 1 1-1zm13 3v7a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V6h14z"/>
        </svg>
        {{ .title }}
      </h4>
      <div class="filter-options">
        {{ $taxonomy := $.Site.Taxonomies.sectors }}
        {{ range $taxonomy.Alphabetical }}
          <label class="filter-option">
            <input type="checkbox" data-taxonomy="sectors" value="{{ .Page.Title }}">
            <span>{{ .Page.Title | humanize }} <small>({{ .Count }})</small></span>
          </label>
        {{ end }}
      </div>
    </div>
  {{ end }}

  <!-- Attributes Filter -->
  {{ with $dimensions.attributes }}
    <div class="filter-group">
      <h4 class="filter-group-title" style="color: {{ .colorHex }}">
        <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
          <path d="M3.612 15.443c-.386.198-.824-.149-.746-.592l.83-4.73L.173 6.765c-.329-.314-.158-.888.283-.95l4.898-.696L7.538.792c.197-.39.73-.39.927 0l2.184 4.327 4.898.696c.441.062.612.636.282.95l-3.522 3.356.83 4.73c.078.443-.36.79-.746.592L8 13.187l-4.389 2.256z"/>
        </svg>
        {{ .title }}
      </h4>
      <div class="filter-options">
        {{ $taxonomy := $.Site.Taxonomies.attributes }}
        {{ range $taxonomy.Alphabetical }}
          <label class="filter-option">
            <input type="checkbox" data-taxonomy="attributes" value="{{ .Page.Title }}">
            <span>{{ .Page.Title | humanize }} <small>({{ .Count }})</small></span>
          </label>
        {{ end }}
      </div>
    </div>
  {{ end }}

  <!-- Signals Filter -->
  {{ with $dimensions.signals }}
    <div class="filter-group">
      <h4 class="filter-group-title" style="color: {{ .colorHex }}">
        <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
          <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
          <path d="M8 13A5 5 0 1 1 8 3a5 5 0 0 1 0 10zm0 1A6 6 0 1 0 8 2a6 6 0 0 0 0 12z"/>
          <path d="M8 11a3 3 0 1 1 0-6 3 3 0 0 1 0 6zm0 1a4 4 0 1 0 0-8 4 4 0 0 0 0 8z"/>
        </svg>
        {{ .title }}
      </h4>
      <div class="filter-options">
        {{ $taxonomy := $.Site.Taxonomies.signals }}
        {{ range $taxonomy.Alphabetical }}
          <label class="filter-option">
            <input type="checkbox" data-taxonomy="signals" value="{{ .Page.Title }}">
            <span>{{ .Page.Title | humanize }} <small>({{ .Count }})</small></span>
          </label>
        {{ end }}
      </div>
    </div>
  {{ end }}

  <!-- Result Count -->
  <div class="filter-result-count">
    <span data-result-count></span>
  </div>
</div>

<style>
.filter-panel {
  background: white;
  border: 1px solid var(--neutral-200);
  border-radius: var(--radius-lg);
  padding: var(--space-6);
}

.filter-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: var(--space-6);
  padding-bottom: var(--space-4);
  border-bottom: 2px solid var(--neutral-200);
}

.filter-header h3 {
  font-size: var(--text-xl);
  margin: 0;
}

.filter-clear {
  display: flex;
  align-items: center;
  gap: var(--space-2);
  padding: var(--space-2) var(--space-4);
  font-size: var(--text-sm);
  font-weight: var(--font-medium);
  color: var(--primary-600);
  background: transparent;
  border: 1px solid var(--primary-300);
  border-radius: var(--radius-md);
  cursor: pointer;
  transition: all 0.2s ease;
}

.filter-clear:hover {
  background: var(--primary-50);
  border-color: var(--primary-500);
}

.filter-count {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  min-width: 20px;
  height: 20px;
  padding: 0 var(--space-1);
  background: var(--primary-500);
  color: white;
  font-size: var(--text-xs);
  font-weight: var(--font-bold);
  border-radius: var(--radius-full);
}

.filter-count[hidden] {
  display: none;
}

.filter-group {
  margin-bottom: var(--space-6);
}

.filter-group-title {
  display: flex;
  align-items: center;
  gap: var(--space-2);
  font-size: var(--text-base);
  font-weight: var(--font-bold);
  margin-bottom: var(--space-3);
  text-transform: uppercase;
  letter-spacing: var(--tracking-wide);
}

.filter-options {
  display: flex;
  flex-direction: column;
  gap: var(--space-2);
}

.filter-option {
  display: flex;
  align-items: center;
  gap: var(--space-2);
  padding: var(--space-2);
  cursor: pointer;
  border-radius: var(--radius-sm);
  transition: background-color 0.2s ease;
}

.filter-option:hover {
  background: var(--neutral-100);
}

.filter-option input[type="checkbox"] {
  width: 18px;
  height: 18px;
  cursor: pointer;
}

.filter-option span {
  font-size: var(--text-sm);
  color: var(--neutral-800);
}

.filter-option small {
  color: var(--neutral-500);
  font-size: var(--text-xs);
}

.filter-result-count {
  margin-top: var(--space-6);
  padding-top: var(--space-4);
  border-top: 1px solid var(--neutral-200);
  text-align: center;
  font-size: var(--text-sm);
  font-weight: var(--font-semibold);
  color: var(--neutral-700);
}
</style>
